<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>A Bridge Too Far :: Home</title>

    <!-- bootstrap css file. freely available under MIT license,
    used for academic purposes -->
    <link
      href="http://netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css"
      rel="stylesheet">
    <link href="css/main.css" rel="stylesheet">

    <!-- jQuery hosted by google -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

    <!-- Simple show/hide script for the login form -->
    <script>
      function popup(showhide) {
        if(showhide == "show") {
          document.getElementById('login').style.display="block";
        } else if (showhide == "hide") {
          document.getElementById('login').style.display="none";
        }
      }
    </script>

    <!-- Various AJAX handler scripts -->
    <script>
      // Login AJAX Handler
      $(document).ready(function() {
	       $("#add_err").css('display', 'none', 'important');
	        $("#submit").click(function() {
		        username=$("#username").val();
		        password=$("#password").val();
		        $.ajax( {
	            type: "POST",
	            url: "login.php",
		          data: "username="+username+"&password="+password,
	            success: function(html) {
		            if(html==1) {
                  // Temporary, at least change this to 'current page'
		              window.location="index.php";

                  // Update user details in future.
                  // Instead of refreshing page or moving to index,
                  // simply update the content of the user details
                  // section by implementing an iframe.
		            } else {
		              $("#add_err").css('display', 'inline', 'important');
		              $("#add_err").html("<img src='images/alert.png' /> Wrong username or password");
		            }
	            },
	            beforeSend:function() {
		            $("#add_err").css('display', 'inline', 'important');
		            $("#add_err").html("<img src='images/ajax-loader.gif' /> Loading...")
	            }
		        });
		      return false;
	      });
      });
    </script>
  </head>
  <body>

  	<!-- Header Section -->
  	<header id="page-header" class="container">

      <!-- User details section -->
      <div id="user">
        <span>Welcome!
          <strong> <?php echo $_SESSION['user']['FirstName'] ?></strong> </span>
        <?php if ($_SESSION['auth']) { ?>
          <a href="logout.php">(Logout)</a>
        <?php } else { ?>
          <a href="javascript:popup('show');p">(Login)</a>
        <?php } ?>
        <a href="cart.php">
          <img alt="Shopping Cart"
               src="img/orange-shopping-cart-hi.png"
               width="20px">
          <!-- Show number of cart items user currently has -->
          (<?php $i = isset( $_SESSION['cart']['items'] ) ?
                      count($_SESSION['cart']['items']) :
                      '0';
            echo $i; ?>)
        </a>
      </div>

      <!-- Log-in Form -->
      <div id="login" style="display:none;position:absolute;border:solid 1px #000;top:100px;z-index:10;background:white;">
        <div class="err" id="add_err"></div>
        <form action="login.php" method="post">
          <label for="username">Username:</label>
          <input name="username" id="username" size="14" />
          <label for="password">Password:</label>
          <input name="password" id="password" type="password" size="14" />
          <input type="submit" name="submit" id="submit" value="login" />
        </form>
        <a href="javascript:popup('hide');">close</a>
      </div>

      <!-- Site Name / Banner -->
      <div id="name">
        <a href="index.html">A Bridge Too Far</a>
      </div>
